# üì± Phase 2: –ù–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–µ—Å–µ–Ω–¥–∂–µ—Ä–∞

## ‚ú® –©–æ –Ω–æ–≤–æ–≥–æ

### 1. üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (Reply)
- **–Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:** –°–≤–∞–π–ø–Ω—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è **–ø—Ä–∞–≤–æ—Ä—É—á** üëâ
- –ó'—è–≤–∏—Ç—å—Å—è —ñ–∫–æ–Ω–∫–∞ Reply
- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥–µ –≤–∏–±—Ä–∞–Ω–µ –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- –í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç —ñ –Ω–∞–¥—ñ—à–ª—ñ—Ç—å

### 2. ‚ù§Ô∏è –†–µ–∞–∫—Ü—ñ—ó –µ–º–æ–¥–∂—ñ
- **–Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:** **–î–æ–≤–≥–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å** –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (long press)
- –ó'—è–≤–∏—Ç—å—Å—è –ø–∞–Ω–µ–ª—å –∑ 8 –µ–º–æ–¥–∂—ñ: ‚ù§Ô∏è üëç üòÇ üòÆ üò¢ üôè üî• üëè
- –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –µ–º–æ–¥–∂—ñ —â–æ–± –¥–æ–¥–∞—Ç–∏ —Ä–µ–∞–∫—Ü—ñ—é
- –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–∞ –≤–∂–µ –¥–æ–¥–∞–Ω—É —Ä–µ–∞–∫—Ü—ñ—é —â–æ–± –≤–∏–¥–∞–ª–∏—Ç–∏
- –†–µ–∞–∫—Ü—ñ—ó –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –ø—ñ–¥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –∑ –ª—ñ—á–∏–ª—å–Ω–∏–∫–æ–º

### 3. üòä Emoji Picker (–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –µ–º–æ–¥–∂—ñ)
- **–Ø–∫ –≤—ñ–¥–∫—Ä–∏—Ç–∏:** –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **üòä** –±—ñ–ª—è –ø–æ–ª—è –≤–≤–æ–¥—É
- 8 –∫–∞—Ç–µ–≥–æ—Ä—ñ–π: –°–º–∞–π–ª–∏–∫–∏, –ñ–µ—Å—Ç–∏, –¢–≤–∞—Ä–∏–Ω–∏, –á–∂–∞, –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, –ü–æ–¥–æ—Ä–æ–∂—ñ, –û–±'—î–∫—Ç–∏, –°–∏–º–≤–æ–ª–∏
- –ë—ñ–ª—å—à–µ 400 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –µ–º–æ–¥–∂—ñ
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–∏—Ö –µ–º–æ–¥–∂—ñ —á–µ—Ä–µ–∑ API

### 4. üé≠ Sticker Picker (–ü–∞–Ω–µ–ª—å —Å—Ç—ñ–∫–µ—Ä—ñ–≤)
- **–Ø–∫ –≤—ñ–¥–∫—Ä–∏—Ç–∏:** –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **üé≠** (StickyNote2) –±—ñ–ª—è –ø–æ–ª—è –≤–≤–æ–¥—É
- 32 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö —Å—Ç—ñ–∫–µ—Ä–∏ —É —Å—ñ—Ç—Ü—ñ 4x4
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–∏—Ö —Å—Ç—ñ–∫–µ—Ä-–ø–∞–∫—ñ–≤ —á–µ—Ä–µ–∑ API
- –°—Ç—ñ–∫–µ—Ä–∏ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –æ–¥–Ω–∏–º –∫–ª—ñ–∫–æ–º

### 5. ‚úì‚úì –ì–∞–ª–æ—á–∫–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—è
- **‚úì** —Å—ñ—Ä–æ–≥–æ –∫–æ–ª—å–æ—Ä—É - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ
- **‚úì‚úì** —Å—ñ—Ä–æ–≥–æ –∫–æ–ª—å–æ—Ä—É - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
- **‚úì‚úì** —Å–∏–Ω—å–æ–≥–æ –∫–æ–ª—å–æ—Ä—É - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ—á–∏—Ç–∞–Ω–æ
- –í—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –¥–ª—è –≤–ª–∞—Å–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (–ø—Ä–∞–≤–æ—Ä—É—á)

### 6. ‚ú® –ê–Ω—ñ–º–∞—Ü—ñ—ó
- **–ü–æ—è–≤–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:** –ø–ª–∞–≤–Ω–∏–π slide-in + fade-in
- **–†–µ–∞–∫—Ü—ñ—ó:** –ø—Ä—É–∂–Ω–∞ scale –∞–Ω—ñ–º–∞—Ü—ñ—è (bounce effect)
- **–ü–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è:** smooth repositioning –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

## üé® –ö–∞—Å—Ç–æ–º–Ω—ñ –µ–º–æ–¥–∂—ñ —Ç–∞ —Å—Ç—ñ–∫–µ—Ä–∏

–î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ API –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–∏—Ö –µ–º–æ–¥–∂—ñ —Ç–∞ —Å—Ç—ñ–∫–µ—Ä—ñ–≤ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ñ–∞–π–ª—ñ:
**`EMOJI_STICKERS_API.md`**

### –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–∏—Ö –µ–º–æ–¥–∂—ñ:

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –µ–º–æ–¥–∂—ñ-–ø–∞–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
2. –ê–∫—Ç–∏–≤—É–π—Ç–µ –ø–∞–∫ —á–µ—Ä–µ–∑ API: `POST ?type=activate_emoji_pack`
3. –ï–º–æ–¥–∂—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑'—è–≤–ª—è—Ç—å—Å—è —É –≤–∫–ª–∞–¥—Ü—ñ "CUSTOM" –≤ Emoji Picker

### –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–∏—Ö —Å—Ç—ñ–∫–µ—Ä—ñ–≤:

1. –°—Ç–≤–æ—Ä—ñ—Ç—å —Å—Ç—ñ–∫–µ—Ä-–ø–∞–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
2. –ê–∫—Ç–∏–≤—É–π—Ç–µ –ø–∞–∫ —á–µ—Ä–µ–∑ API: `POST ?type=activate_sticker_pack`
3. –°—Ç—ñ–∫–µ—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑'—è–≤–ª—è—Ç—å—Å—è –≤ Sticker Picker –∑ –æ–∫—Ä–µ–º–æ—é –≤–∫–ª–∞–¥–∫–æ—é

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:
- `MessagesScreen.kt` - –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω –∑ —É—Å—ñ–º–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏
- `EmojiPicker.kt` - –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –µ–º–æ–¥–∂—ñ
- `StickerPicker.kt` - –ø–∞–Ω–µ–ª—å —Å—Ç—ñ–∫–µ—Ä—ñ–≤
- `ReactionPicker` - –ø–∞–Ω–µ–ª—å —à–≤–∏–¥–∫–∏—Ö —Ä–µ–∞–∫—Ü—ñ–π (–≤ MessagesScreen)
- `MessageReactions` - –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–µ–∞–∫—Ü—ñ–π –ø—ñ–¥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º
- `MessageStatusIcon` - –≥–∞–ª–æ—á–∫–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—è

### ViewModel –º–µ—Ç–æ–¥–∏:
- `toggleReaction(messageId, emoji)` - –¥–æ–¥–∞—Ç–∏/–≤–∏–¥–∞–ª–∏—Ç–∏ —Ä–µ–∞–∫—Ü—ñ—é
- `sendSticker(stickerId)` - –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —Å—Ç—ñ–∫–µ—Ä
- `sendMessage(..., replyToId)` - –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é

### API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏:
- `POST ?type=add_message_reaction` - –¥–æ–¥–∞—Ç–∏ —Ä–µ–∞–∫—Ü—ñ—é
- `POST ?type=remove_message_reaction` - –≤–∏–¥–∞–ª–∏—Ç–∏ —Ä–µ–∞–∫—Ü—ñ—é
- `GET ?type=get_message_reactions` - –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∞–∫—Ü—ñ—ó
- `GET ?type=get_emoji_packs` - –æ—Ç—Ä–∏–º–∞—Ç–∏ –µ–º–æ–¥–∂—ñ-–ø–∞–∫–∏
- `POST ?type=activate_emoji_pack` - –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –µ–º–æ–¥–∂—ñ-–ø–∞–∫
- `GET ?type=get_sticker_packs` - –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç—ñ–∫–µ—Ä-–ø–∞–∫–∏
- `POST ?type=activate_sticker_pack` - –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —Å—Ç—ñ–∫–µ—Ä-–ø–∞–∫
- `POST ?type=send_sticker` - –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —Å—Ç—ñ–∫–µ—Ä

## üìù –ó–º—ñ–Ω–∏ –≤ –¥–∞–Ω–∏—Ö

### Message –º–æ–¥–µ–ª—å –æ–Ω–æ–≤–ª–µ–Ω–∞:
```kotlin
data class Message(
    ...
    @SerializedName("reactions") val reactions: List<MessageReaction>? = null,
    @SerializedName("is_read") val isRead: Boolean? = false,
    @SerializedName("reply_to_id") val replyToId: Long? = null
)
```

### –ù–æ–≤—ñ –º–æ–¥–µ–ª—ñ:
- `MessageReaction` - —Ä–µ–∞–∫—Ü—ñ—è –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `ReactionGroup` - –∑–≥—Ä—É–ø–æ–≤–∞–Ω—ñ —Ä–µ–∞–∫—Ü—ñ—ó –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
- `CustomEmoji` - –∫–∞—Å—Ç–æ–º–Ω–µ –µ–º–æ–¥–∂—ñ
- `EmojiPack` - –ø–∞–∫–µ—Ç –∫–∞—Å—Ç–æ–º–Ω–∏—Ö –µ–º–æ–¥–∂—ñ
- `Sticker` - —Å—Ç—ñ–∫–µ—Ä
- `StickerPack` - –ø–∞–∫–µ—Ç —Å—Ç—ñ–∫–µ—Ä—ñ–≤

## üöÄ –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É

1. **–ü–µ—Ä–µ–∫–æ–º–ø—ñ–ª—é–π—Ç–µ –ø—Ä–æ–µ–∫—Ç:** `./gradlew assembleDebug`
2. **–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–∞ –ø—Ä–∏—Å—Ç—Ä—ñ–π**
3. **–í—ñ–¥–∫—Ä–∏–π—Ç–µ —á–∞—Ç –∑ –±—É–¥—å-—è–∫–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**
4. **–ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:**
   - –°–≤–∞–π–ø–Ω—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–∞–≤–æ—Ä—É—á –¥–ª—è Reply
   - –î–æ–≤–≥–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è —Ä–µ–∞–∫—Ü—ñ–π
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å üòä –¥–ª—è emoji picker
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å üé≠ –¥–ª—è sticker picker
   - –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≥–∞–ª–æ—á–∫–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—è –Ω–∞ –≤–ª–∞—Å–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è—Ö

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ —â–æ—Å—å –Ω–µ –ø—Ä–∞—Ü—é—î:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ —î —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–∑'—î–¥–Ω–∞–Ω–Ω—è (API –∑–∞–ø–∏—Ç–∏)
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: —Ñ—ñ–ª—å—Ç—Ä "MessagesViewModel" —Ç–∞ "MessageBubble"
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ —Å–µ—Ä–≤–µ—Ä –ø—ñ–¥—Ç—Ä–∏–º—É—î –Ω–æ–≤—ñ API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ `message.reactions` –Ω–µ null —É –≤—ñ–¥–ø–æ–≤—ñ–¥—è—Ö API

---

**–í–µ—Ä—Å—ñ—è:** Phase 2.0
**–î–∞—Ç–∞:** 2024-12-25
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ç–∞ –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ
