# ⚡ WorldMates Messenger - Полный TODO лист

> **Последнее обновление:** 2026-01-09  
> **Версия:** 2.0-EDIT-FIX  
> **Ветка:** claude/add-user-blocking-DLAQa  
> **Статус:** PRODUCTION READY 🚀

---

## 📊 ТЕКУЩИЙ СТАТУС ПРОЕКТА

### ✅ ЧТО УЖЕ РАБОТАЕТ (95% готовности):

#### **Чаты и сообщения:**
- ✅ Личные чаты 1-на-1 с шифрованием AES-256-GCM
- ✅ Групповые чаты (создание, редактирование, администрирование)
- ✅ Отправка текста, фото, видео, аудио, файлов, документов
- ✅ Голосовые сообщения с воспроизведением
- ✅ GIF через Giphy API
- ✅ Стикеры (локальные + Strapi CMS)
- ✅ Эмодзи реакции на сообщения (6 типов)
- ✅ Ответ на сообщение (swipe-to-reply)
- ✅ Пересылка сообщений (forward)
- ✅ Редактирование сообщений
- ✅ Удаление сообщений (для себя/для всех)
- ✅ Закрепление сообщений в группах
- ✅ Избранные сообщения
- ✅ Поиск по сообщениям в группах
- ✅ Фильтр медиа (фото, видео, аудио, файлы, ссылки)
- ✅ Изменение цвета/темы чата
- ✅ Изменение обоев чата
- ✅ Галочки прочитанности (одна/две)
- ✅ Статус "печатает..." в реальном времени
- ✅ Отправка геолокации
- ✅ Отправка контактов
- ✅ Черновики (автосохранение каждые 2 сек)

#### **Группы:**
- ✅ Создание групп (публичные/приватные)
- ✅ Редактирование (название, описание, аватар)
- ✅ Добавление/удаление участников
- ✅ Права участников (владелец, админ, модератор, участник)
- ✅ Закрепленные сообщения с баннером
- ✅ Отключение/включение уведомлений (mute/unmute)
- ✅ QR-код для вступления + генерация
- ✅ Загрузка аватара группы (multipart upload)
- ✅ Поиск по сообщениям в группе (Telegram-style)
- ✅ Управление правами участников

#### **Каналы:**
- ✅ Создание каналов (4-step wizard)
- ✅ Подписка/отписка
- ✅ Публикация/редактирование/удаление постов
- ✅ Реакции на посты (6 типов)
- ✅ Комментарии к постам
- ✅ Реакции на комментарии
- ✅ Закрепленные посты
- ✅ Статистика просмотров постов
- ✅ Статистика канала
- ✅ Администраторы с правами
- ✅ Настройки каналов (комментарии, реакции, slow mode)
- ✅ QR-код для подписки
- ✅ Загрузка аватара канала
- ✅ Mute/Unmute уведомлений
- ✅ Поиск каналов
- ✅ Детальный просмотр постов
- ✅ Поширення постов
- ✅ Real-time обновления (polling 15-20 сек)

#### **Stories (Истории):**
- ✅ Создание stories (фото/видео)
- ✅ Просмотр в полноэкранном режиме
- ✅ Автопрогресс (20 сек фото, авто видео)
- ✅ Навигация (свайпы, пауза)
- ✅ Реакции (6 типов)
- ✅ Комментарии
- ✅ Статистика просмотров
- ✅ Автоудаление через 24/48 часов
- ✅ Лимиты по подписке (free/PRO)
- ✅ Два типа: личные + канальные
- ✅ ExoPlayer для видео
- ✅ Real-time обновления

#### **Звонки:**
- ✅ Аудио звонки 1-на-1 (Agora RTC)
- ✅ Видео звонки 1-на-1 (Agora RTC)
- ✅ Групповые звонки
- ✅ WebRTC с ICE candidates
- ✅ Push-уведомления
- ✅ История звонков
- ✅ Статистика звонков

#### **Безопасность:**
- ✅ PIN-код блокировка
- ✅ Биометрия (отпечаток/Face ID)
- ✅ 2FA (Google Authenticator)
- ✅ Управление сеансами
- ✅ Блокировка пользователей (100% готово)
- ✅ Настройки приватности
- ✅ Шифрование AES-256-GCM

#### **Облачные бэкапы:**
- ✅ Автозагрузка медиа
- ✅ Лимиты размера файлов
- ✅ Управление кешем
- ✅ Выбор провайдера (LOCAL/GOOGLE/MEGA/DROPBOX)
- ✅ Прогресс-бар синхронизации
- ✅ Сохранение в галерею
- ✅ Кэширование в Room Database

#### **Настройки:**
- ✅ Редактирование профиля
- ✅ Загрузка аватара/обложки
- ✅ Темы (светлая/темная/градиенты)
- ✅ Выбор обоев
- ✅ Стили пузырьков
- ✅ Быстрая реакция
- ✅ UI стиль (Telegram/WorldMates)
- ✅ Уведомления
- ✅ Приватность
- ✅ Список заблокированных
- ✅ Мои группы
- ✅ Подписчики/подписки

---

## 🔥 КРИТИЧНО (Сделать ПЕРВЫМ - 2 недели)

### 1. ⚠️ Замена API ключей (1 день)
```
❌ СЕЙЧАС: Демо ключи
✅ НУЖНО:
   - Giphy API ключ (реальный)
   - Google Maps API (для геолокации)
   - Agora App ID и Certificate (production)
   - Проверить все TODO с "API_KEY"
```

### 2. 🐛 Stories навигация (3 дня)
```
⚠️ ПРОБЛЕМА: Показывается только последняя story
✅ НУЖНО:
   - Исправить SwipeableStories между stories одного user
   - HorizontalPager для списка stories
   
   Файлы:
   - ui/stories/StoryViewerActivity.kt
```

### 3. 🔄 Каналы на Socket.IO (3 дня)
```
⚠️ ПРОБЛЕМА: Polling каждые 15 сек
✅ НУЖНО:
   Backend (socket-calls-handler.js):
   - channel:subscribe → join room
   - channel:new_post → broadcast
   - channel:post_updated → notify
   
   Android (ChannelsViewModel.kt):
   - Socket.IO listeners
   - Удалить polling
```

### 4. 🔐 Backend запрет от блокированных (2 дня)
```
⚠️ СЕЙЧАС: Кнопка есть, backend не проверяет
✅ НУЖНО:
   Файл: send-message.php
   
   Добавить:
   1. Wo_IsBlocked($recipient_id) перед отправкой
   2. Ошибка 403 если заблокирован
   3. Проверка в обе стороны
```

### 5. 📱 QR-сканер (2 дня)
```
⚠️ СЕЙЧАС: Только ручной ввод
✅ НУЖНО:
   - CameraX + ML Kit Barcode Scanner
   - QrScannerDialog
   - Парсинг QR → group_token
```

### 6. 📊 Cloud Backup статистика (2 дня)
```
⚠️ СЕЙЧАС: Заглушка "Обчислюється..."
✅ НУЖНО:
   1. Room DB: SELECT SUM(size)
   2. NetworkStatsManager
   3. WorkManager для фоновой синхронизации
```

---

## ⭐ ВЫСОКИЙ ПРИОРИТЕТ (1 месяц)

### 7. 🎥 Видеозвонки UI (3 дня)
```
⚠️ ЧАСТИЧНО
✅ НУЖНО:
   - SurfaceViewRenderer
   - PiP для локального видео
   - Переключение камер
   - Управление качеством
```

### 8. 🔄 Мультиустройство (5 дней)
```
⚠️ ЧАСТИЧНО: sync_session есть
✅ НУЖНО:
   - Cloud хранение всех сообщений
   - Синхронизация прочтений
   - Push на все устройства
```

### 9. 🔍 Глобальный поиск (4 дня)
```
❌ НЕТ: Кнопка есть
✅ НУЖНО:
   - search_messages.php
   - MessageSearchScreen.kt
   - Фильтры (дата, медиа, от кого)
```

### 10. 🔐 Секретные чаты (7 дней)
```
❌ НЕТ
✅ НУЖНО:
   - Wo_SecretChats таблица
   - E2E Double Ratchet
   - Таймер самоуничтожения
   - FLAG_SECURE (запрет скриншотов)
```

### 11. 📤 Облачные провайдеры (7 дней)
```
⚠️ СЕЙЧАС: Выбор есть, интеграции нет
✅ НУЖНО:
   - Google Drive API (OAuth 2.0)
   - MEGA SDK
   - Dropbox API
```

### 12. 📊 Статистика каналов (3 дня)
```
⚠️ ЧАСТИЧНО
✅ НУЖНО:
   - Детальная по дням/неделям
   - Графики (Vico)
   - Топ посты
   - География подписчиков
```

---

## 💡 СРЕДНИЙ ПРИОРИТЕТ (2 месяца)

### 13. 🎨 Стикеры магазин (5 дней)
- Магазин стикеров
- Анимированные (Lottie)
- Создание своих

### 14. 🗺️ Live Location (4 дня)
- Google Maps в чате
- Live Location (15 мин / 1 час / 8 часов)
- PlacePicker

### 15. 📝 Заметки/Напоминания (3 дня)
- Wo_Notes таблица
- Напоминания с push
- Теги

### 16. 🎭 Маски для видео (5 дней)
- ML Kit Face Detection
- Маски (Instagram-style)
- Фильтры

### 17. 🔊 Голосовые чаты (7 дней)
- Voice Rooms (Clubhouse-style)
- Wo_VoiceRooms таблица
- Роли (host, speaker, listener)

### 18. 📁 Файловый менеджер (3 дня)
- Files Tab
- Сортировка
- Preview для PDF/DOCX

### 19. 🎮 Мини-игры (5 дней)
- HTML5 игры
- Приглашения
- Лидерборд

### 20. 💬 Боты (10 дней)
- Bot API (Telegram-style)
- Webhook
- Inline режим
- Custom keyboards

---

## 🎨 НИЗКИЙ ПРИОРИТЕТ (3+ месяца)

### 21. 🎬 Screen Sharing
- MediaProjection API
- В видеозвонках

### 22. 🎪 Групповые видеозвонки до 20
- Grid layout
- Active speaker detection

### 23-29. Социальная сеть
- 🏪 Маркетплейс
- 📰 Лента новостей
- 📄 Страницы
- 📅 События
- 💼 Вакансии
- 🎬 Блоги
- 🎥 Фильмы/игры

### 30. 💰 Криптовалюта и NFT
- Крипто-кошелек
- NFT аватары

---

## 🐛 КРИТИЧНЫЕ БАГИ

1. ⚠️ Stories навигация не работает → КРИТИЧНЫЙ
2. ⚠️ Giphy демо ключ → КРИТИЧНЫЙ
3. ⚠️ Нет проверки блокировки при отправке → ВЫСОКИЙ
4. ⚠️ QR-сканер не реализован → СРЕДНИЙ

---

## 📈 ОПТИМИЗАЦИЯ

### Socket.IO:
- ✅ Compression (60-70%)
- ⚠️ MessagePack вместо JSON
- ⚠️ Батчинг сообщений

### База данных:
- ⚠️ Индексы для частых запросов
- ⚠️ Партиционирование Wo_Messages
- ⚠️ Redis кеширование

### APK:
- ⚠️ ProGuard/R8
- ⚠️ App Bundle
- ⚠️ Split APKs

### Медиа:
- ✅ Coil + ExoPlayer
- ⚠️ WebP/AVIF
- ⚠️ Автокомпрессия

---

## 🧪 ТЕСТИРОВАНИЕ

- ❌ Unit тесты (JUnit + Mockito)
- ❌ UI тесты (Espresso + Compose)
- ❌ E2E тесты (Appium)

---

## 📚 ДОКУМЕНТАЦИЯ

### Есть:
- ✅ QUICK_TODO_LIST.md
- ✅ CLOUD_BACKUP_V2.md
- ✅ STORIES_UI_IMPLEMENTATION.md
- ✅ CHANNEL_FULL_FEATURES.md

### Нужно:
- ⚠️ API.md
- ⚠️ ARCHITECTURE.md
- ⚠️ DEPLOYMENT.md
- ⚠️ SECURITY.md

---

## 🎯 РЕКОМЕНДУЕМЫЙ ПЛАН

### Неделя 1-2 (КРИТИЧНОЕ):
1. API ключи → production
2. Stories навигация fix
3. Каналы → Socket.IO
4. Backend блокировка

### Неделя 3-4 (ВЫСОКИЙ):
5. QR-сканер
6. Cloud Backup stats
7. Видеозвонки UI
8. Мультиустройство

### Месяц 2 (СРЕДНИЙ):
9. Глобальный поиск
10. Секретные чаты
11. Облачные провайдеры
12. Стикеры магазин

### Месяц 3+ (НИЗКИЙ):
13. Боты
14. Социальная сеть
15. Маркетплейс

---

## 📊 СТАТИСТИКА

### Backend:
- **API Endpoints:** 210+
- **Строк PHP:** ~150,000+
- **Таблиц БД:** 121
- **Node.js моделей:** 100+

### Android:
- **Файлов Kotlin:** 144
- **Activities:** 14
- **ViewModels:** 14
- **Строк Kotlin:** ~80,000+

### Готовность:
```
┌────────────────────────────────────┐
│ Базовый функционал:                │
│ ██████████ 95% ✅                   │
├────────────────────────────────────┤
│ Дополнительные фичи:               │
│ ██████░░░░ 60% ⚠️                   │
├────────────────────────────────────┤
│ Социальная сеть:                   │
│ ████░░░░░░ 40% ❌                   │
├────────────────────────────────────┤
│ ОБЩАЯ ГОТОВНОСТЬ:                  │
│ ████████░░ 80% 🚀                   │
└────────────────────────────────────┘
```

---

## 💎 КОНКУРЕНТНЫЕ ПРЕИМУЩЕСТВА

### УЖЕ ЕСТЬ:
- ✅ Material You (динамические цвета)
- ✅ AES-256-GCM (современное шифрование)
- ✅ Каналы + Stories (2 в 1)
- ✅ Красивый UI (Jetpack Compose)
- ✅ Real-time Socket.IO
- ✅ 2FA + биометрия
- ✅ Блокировка пользователей
- ✅ QR-коды

### БУДЕТ УНИКАЛЬНЫМ:
- 🔥 Маркетплейс
- 🔥 NFT аватары
- 🔥 Крипто-платежи
- 🔥 Voice Rooms
- 🔥 AI-боты

---

## 🚀 PRODUCTION ЧЕКЛИСТ

- [ ] API ключи → production
- [ ] Socket.IO production сервер
- [ ] HTTPS + SSL
- [ ] Firebase CM + Crashlytics
- [ ] Agora production
- [ ] ProGuard/R8
- [ ] Все TODO исправлены
- [ ] Тестирование
- [ ] Privacy Policy + ToS
- [ ] Альфа/бета тестирование
- [ ] Google Play Release

---

**⚡ WorldMates - Мессенджер нового поколения для Украины!**

**GitHub:** https://github.com/dncdante911/worldmates_mess_v1.0  
**Версия:** 2.0-EDIT-FIX  
**Последнее обновление:** 2026-01-09
