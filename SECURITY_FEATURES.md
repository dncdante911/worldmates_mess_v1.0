# üîê –§—É–Ω–∫—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏ WorldMates Messenger

## –û–≥–ª—è–¥

WorldMates Messenger —Ç–µ–ø–µ—Ä –≤–∫–ª—é—á–∞—î –ø–æ–≤–Ω–∏–π –Ω–∞–±—ñ—Ä —Ñ—É–Ω–∫—Ü—ñ–π –±–µ–∑–ø–µ–∫–∏ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤–∞—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ.

---

## ‚ú® –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

### 1. üì± –î–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (2FA)

**–©–æ —Ü–µ:**
–î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –∑–∞—Ö–∏—Å—Ç—É –≤–∞—à–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É —á–µ—Ä–µ–∑ Google Authenticator.

**–Ø–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è** ‚Üí **–ë–µ–∑–ø–µ–∫–∞** ‚Üí **–î–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"–£–≤—ñ–º–∫–Ω—É—Ç–∏ 2FA"**
3. –°–∫–∞–Ω—É–π—Ç–µ QR-–∫–æ–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Google Authenticator
4. –í–≤–µ–¥—ñ—Ç—å 6-–∑–Ω–∞—á–Ω–∏–π –∫–æ–¥ –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
5. **–í–ê–ñ–õ–ò–í–û:** –ó–±–µ—Ä–µ–∂—ñ—Ç—å 10 —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–¥—ñ–≤ —É –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:**
- ‚úÖ –°—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ Google Authenticator
- ‚úÖ 10 —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–¥—ñ–≤ –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É
- ‚úÖ TOTP (Time-based One-Time Password) —Å—Ç–∞–Ω–¥–∞—Ä—Ç RFC 6238
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∑–º—ñ–Ω–∞ –∫–æ–¥—É –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥

**–í—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:**
–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ‚Üí –ë–µ–∑–ø–µ–∫–∞ ‚Üí –î–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è ‚Üí –í–∏–º–∫–Ω—É—Ç–∏ 2FA

---

### 2. üîí –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—É (PIN + –ë—ñ–æ–º–µ—Ç—Ä—ñ—è)

**–©–æ —Ü–µ:**
–ó–∞—Ö–∏—Å—Ç –¥–æ–¥–∞—Ç–∫—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é PIN-–∫–æ–¥—É –∞–±–æ –±—ñ–æ–º–µ—Ç—Ä–∏—á–Ω–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (–≤—ñ–¥–±–∏—Ç–æ–∫ –ø–∞–ª—å—Ü—è / —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –æ–±–ª–∏—á—á—è).

**–Ø–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏:**

#### PIN-–∫–æ–¥:
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è** ‚Üí **–ë–µ–∑–ø–µ–∫–∞** ‚Üí **–ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—É**
2. –£–≤—ñ–º–∫–Ω—ñ—Ç—å **"PIN-–∫–æ–¥"**
3. –í–≤–µ–¥—ñ—Ç—å 4-–∑–Ω–∞—á–Ω–∏–π PIN-–∫–æ–¥
4. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å PIN-–∫–æ–¥

#### –ë—ñ–æ–º–µ—Ç—Ä—ñ—è:
1. –°–ø–æ—á–∞—Ç–∫—É –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ PIN-–∫–æ–¥ (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)
2. –£–≤—ñ–º–∫–Ω—ñ—Ç—å **"–ë—ñ–æ–º–µ—Ç—Ä–∏—á–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è"**
3. –¢–µ–ø–µ—Ä –¥–æ–¥–∞—Ç–æ–∫ –±—É–¥–µ —Ä–æ–∑–±–ª–æ–∫–æ–≤—É–≤–∞—Ç–∏—Å—å —á–µ—Ä–µ–∑ Face ID / Fingerprint

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞–π–º–∞—É—Ç—É:**
–í–∏–±–µ—Ä—ñ—Ç—å, —á–µ—Ä–µ–∑ —è–∫–∏–π —á–∞—Å –¥–æ–¥–∞—Ç–æ–∫ –±–ª–æ–∫—É–≤–∞—Ç–∏–º–µ—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:
- –û–¥—Ä–∞–∑—É
- 1 —Ö–≤–∏–ª–∏–Ω–∞
- 5 —Ö–≤–∏–ª–∏–Ω
- 10 —Ö–≤–∏–ª–∏–Ω
- 30 —Ö–≤–∏–ª–∏–Ω
- 1 –≥–æ–¥–∏–Ω–∞
- –ù—ñ–∫–æ–ª–∏

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:**
- ‚úÖ –ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è PIN (SHA-256 —Ö–µ—à)
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Face ID –Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Fingerprint
- ‚úÖ –ê–Ω—ñ–º–æ–≤–∞–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–≤–µ–¥–µ–Ω–Ω—è PIN
- ‚úÖ –í—ñ–±—Ä–∞—Ü—ñ—è –ø—Ä–∏ –≤–≤–µ–¥–µ–Ω–Ω—ñ
- ‚úÖ –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö —Å–ø—Ä–æ–±

---

## üõ†Ô∏è –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:

#### 2FA:
- **TOTP Generator**: –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è RFC 6238
- **QR Code**: ZXing –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó QR-–∫–æ–¥—ñ–≤
- **Base32**: Apache Commons Codec –¥–ª—è –∫–æ–¥—É–≤–∞–Ω–Ω—è
- **Recovery Codes**: 10 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö 8-–∑–Ω–∞—á–Ω–∏—Ö –∫–æ–¥—ñ–≤

#### –ë—ñ–æ–º–µ—Ç—Ä—ñ—è:
- **BiometricPrompt**: androidx.biometric
- **EncryptedSharedPreferences**: –ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è
- **SHA-256**: –•–µ—à—É–≤–∞–Ω–Ω—è PIN-–∫–æ–¥—ñ–≤

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:

```
utils/security/
‚îú‚îÄ‚îÄ TOTPGenerator.kt          # TOTP –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–∞ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ BiometricAuthManager.kt   # –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±—ñ–æ–º–µ—Ç—Ä—ñ—î—é
‚îî‚îÄ‚îÄ SecurePreferences.kt      # –ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è

ui/settings/security/
‚îú‚îÄ‚îÄ TwoFactorAuthScreen.kt    # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è 2FA
‚îú‚îÄ‚îÄ AppLockSettingsScreen.kt  # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
‚îî‚îÄ‚îÄ PINScreen.kt              # –í–≤–µ–¥–µ–Ω–Ω—è PIN

ui/security/
‚îî‚îÄ‚îÄ AppLockActivity.kt        # –ï–∫—Ä–∞–Ω –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
```

---

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö

### –ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è (EncryptedSharedPreferences):

```kotlin
// PIN
- pin_hash: String (SHA-256)
- pin_enabled: Boolean

// –ë—ñ–æ–º–µ—Ç—Ä—ñ—è
- biometric_enabled: Boolean
- app_lock_timeout: Long (–º—Å)
- last_unlock_time: Long

// 2FA
- 2fa_enabled: Boolean
- 2fa_secret: String (Base32)
- 2fa_backup_codes: List<String>
- 2fa_backup_codes_used: List<String>
```

---

## üîÑ –ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –±–ª–æ–∫—É–≤–∞–Ω–Ω—è

1. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–≥–æ—Ä—Ç–∞—î –¥–æ–¥–∞—Ç–æ–∫** ‚Üí `onPause()`
2. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è** ‚Üí `onResume()`
3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞–π–º–∞—É—Ç—É**:
   - –Ø–∫—â–æ —á–∞—Å > —Ç–∞–π–º–∞—É—Ç ‚Üí –ø–æ–∫–∞–∑–∞—Ç–∏ AppLockActivity
   - –Ü–Ω–∞–∫—à–µ ‚Üí –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —Ä–æ–±–æ—Ç—É
4. **–£—Å–ø—ñ—à–Ω–∞ —Ä–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è** ‚Üí –æ–Ω–æ–≤–∏—Ç–∏ last_unlock_time

---

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### –†—É—á–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

#### 2FA:
1. ‚úÖ –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è 2FA
2. ‚úÖ –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è QR-–∫–æ–¥—É
3. ‚úÖ –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è TOTP –∫–æ–¥—É
4. ‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–¥—ñ–≤
5. ‚úÖ –í–∏–º–∫–Ω–µ–Ω–Ω—è 2FA
6. ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–¥—É

#### PIN/–ë—ñ–æ–º–µ—Ç—Ä—ñ—è:
1. ‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è PIN
2. ‚úÖ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è PIN
3. ‚úÖ –†–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ PIN
4. ‚úÖ –†–æ–∑–±–ª–æ–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –±—ñ–æ–º–µ—Ç—Ä—ñ—é
5. ‚úÖ –ó–º—ñ–Ω–∞ —Ç–∞–π–º–∞—É—Ç—É
6. ‚úÖ –í–∏–º–∫–Ω–µ–Ω–Ω—è PIN

---

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –ø—Ä–∏–º—ñ—Ç–∫–∏

### –î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:

1. **–ó–±–µ—Ä–µ–∂—ñ—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–¥–∏ 2FA** —É –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ
2. **–ù–µ –∑–∞–±—É–¥—å—Ç–µ PIN-–∫–æ–¥** - –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–µ —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
3. **–ë—ñ–æ–º–µ—Ç—Ä—ñ—è –≤–∏–º–∞–≥–∞—î PIN** —è–∫ —Ä–µ–∑–µ—Ä–≤–Ω–∏–π –º–µ—Ç–æ–¥
4. **–†–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–¥–∏ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ñ** - –∫–æ–∂–µ–Ω –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑

### –î–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤:

1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `EncryptedSharedPreferences` –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è
2. PIN —Ö–µ—à—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ SHA-256 –ø–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º
3. TOTP –∫–æ–¥–∏ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–µ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä)
4. –ë—ñ–æ–º–µ—Ç—Ä—ñ—è –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ AndroidX BiometricPrompt
5. AppLockActivity –º–∞—î `launchMode="singleInstance"`

---

## üìö –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- [Google Authenticator](https://support.google.com/accounts/answer/1066447)
- [RFC 6238 - TOTP](https://tools.ietf.org/html/rfc6238)
- [Android BiometricPrompt](https://developer.android.com/training/sign-in/biometric-auth)
- [EncryptedSharedPreferences](https://developer.android.com/topic/security/data)

---

## üéØ –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û:**
- [x] TOTP Generator (Google Authenticator)
- [x] BiometricPrompt (Face ID / Fingerprint)
- [x] PIN-–∫–æ–¥ –¥–æ–¥–∞—Ç–∫—É
- [x] QR-–∫–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è
- [x] Recovery codes (10 –∫–æ–¥—ñ–≤)
- [x] –ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è (EncryptedSharedPreferences)
- [x] UI –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å 2FA
- [x] UI –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
- [x] –ï–∫—Ä–∞–Ω –≤–≤–µ–¥–µ–Ω–Ω—è PIN
- [x] AppLockActivity
- [x] –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ Settings

‚è≥ **TODO (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):**
- [ ] –°–µ—Ä–≤–µ—Ä–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ 2FA (–≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ)
- [ ] SMS 2FA —è–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞
- [ ] Email 2FA
- [ ] –Ü—Å—Ç–æ—Ä—ñ—è –≤—Ö–æ–¥—ñ–≤
- [ ] –î–æ–≤—ñ—Ä–µ–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó

---

**–î–∞—Ç–∞:** 2025-12-27
**–í–µ—Ä—Å—ñ—è:** 1.0
**–ê–≤—Ç–æ—Ä:** Claude Code
**–°—Ç–∞—Ç—É—Å:** ‚úÖ PRODUCTION READY
